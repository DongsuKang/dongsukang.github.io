---
title:  "주성분 분석(PCA) 공부 내용 요약 정리"
excerpt: "주성분 분석에 대해 공부한 내용을 이해한만큼이라도 정리해보 "

categories:
  - Machine Learning

toc: true
toc_sticky: true

use_math : true
comments : true
image : true
sitemap :
changefreq : daily
date: 2021-11-14
last_modified_at: 2021-11-14
---


- 아래의 글은 [링크](https://media.pearsoncmg.com/aw/aw_friedberg_linearalgebra_5e/app/companalysis.html) 의 내용과 샘플 데이터를 이용해 주성분 분석에 대해 공부한 내용을 정리하는 글입니다. 
- 본문의 글을 이해하는 과정에서 본문의 글이 충분히 설명해주지 않았던 부분에 대해서도 담고자하였습니다. 당연히 허점이 있을 가능성이 높으니, 틀린 점은 말씀해주세요!

- 사실 PCA는 너무 유명하기 때문에 이 방법이 어떤 방법이고, 어떤 목적으로 사용하는 것인지에 대해서는 구글링을 통해 쉽게 찾을 수 있으므로 굳이 여기다가 적지는 않겠습니다.

## 샘플 데이터 소개

|   Student |   ACT |   FE |   Qav |   Tav |   ACT* |   FE* |   Qav* |   Tav* |
|----------:|------:|-----:|------:|------:|-------:|------:|-------:|-------:|
|         1 |    33 |  181 |    95 |    89 |   1.27 |  0.94 |   1.3  |   0.95 |
|         2 |    31 |  169 |    81 |    89 |   0.8  |  0.48 |   0.29 |   0.95 |
|         3 |    21 |  176 |    65 |    68 |  -1.58 |  0.75 |  -0.88 |  -0.64 |
|         4 |    25 |  181 |    66 |    90 |  -0.63 |  0.94 |  -0.81 |   1.03 |
|         5 |    29 |  169 |    89 |    81 |   0.32 |  0.48 |   0.87 |   0.35 |
|         6 |    24 |  103 |    61 |    57 |  -0.86 | -2.05 |  -1.17 |  -1.47 |
|         7 |    24 |  150 |    81 |    76 |  -0.86 | -0.25 |   0.29 |  -0.03 |
|         8 |    29 |  147 |    86 |    76 |   0.32 | -0.36 |   0.65 |  -0.03 |
|         9 |    36 |  181 |    98 |   102 |   1.98 |  0.94 |   1.52 |   1.94 |
|        10 |    26 |  163 |    72 |    70 |  -0.39 |  0.25 |  -0.37 |  -0.49 |
|        11 |    31 |  163 |    95 |    81 |   0.8  |  0.25 |   1.3  |   0.35 |
|        12 |    29 |  147 |    65 |    67 |   0.32 | -0.36 |  -0.88 |  -0.71 |
|        13 |    23 |  160 |    62 |    68 |  -1.1  |  0.14 |  -1.1  |  -0.64 |
|        14 |    26 |  100 |    63 |    56 |  -0.39 | -2.16 |  -1.02 |  -1.55 |

- 이미 언급한 바와 같이, 위 데이터는 맨 처음 링크의 글에 있는 샘플 데이터이다. 데이터에 대한 설명이 따로 있지는 않았던 것 같아
- 데이터에 대한 설명은 아래와 같이 적혀있었다.
  - ACT : a score from a national test with range 1 to 36
  - FE : the final exam score with range 0 to 200
  - Qav : the mean of eight quiz scores each with range 0 to 100
  - Tav : the mean of three test scores each with range 0 to 100
- 그리고 컬럼 중 *가 붙은 컬럼은 해당 컬럼을 표준화(standardize)한 컬럼이다.
  - 예를 들어서, ACT*는 ACT 각각의 값들을 ACT의 평균을 빼고, ACT의 표준 편차를 나눠준 값이다.


## 상관 계수 행렬 만들기
PCA를 위해 첫 번째로 할 일은 *가 붙어있는 표준화 된 컬럼들의 상관계수 행렬을 만드는 것이다. 그럼 아래와 같은 상관계수 행렬을 얻을 수 있다. 상관계수 행렬을 앞으로 C라고 해보자.

|      |     ACT* |      FE* |     Qav* |     Tav* |
|:-----|---------:|---------:|---------:|---------:|
| ACT* | 1        | 0.334713 | 0.811111 | 0.700861 |
| FE*  | 0.334713 | 1        | 0.498062 | 0.795    |
| Qav* | 0.811111 | 0.498062 | 1        | 0.748438 |
| Tav* | 0.700861 | 0.795    | 0.748438 | 1        |

공분산 행렬이 그러했듯, 상관계수 행렬도 대각성분을 기준으로 같은 값을 가지는 대칭행렬을 가지게 된다. 상관계수의 범위는 항상 -1부터 1사이의 값을 가지는데, 이를 안다면, 상관계수 행렬은 곧 항상 실수값을 가지는 대칭행렬임을 알 수 있다. 그리고 선형 대수를 공부하다보면, 실수값을 가지는 대칭행렬이 특별한 대각화가 가능하다는 것을 알 수 있다,

## 실수값을 가지는 대칭행렬의 특별한 대각화
그 특별한 대각화가 무엇인가 하면은, 우선 아래의 프리드 버그의 선형대수 내용을 하나 참고해보자

>Theorem 6.20
> 실대칭 행렬 A에 대하여 A의 고유 벡터로 이루어진 $F^n$의 정규직교 기저 $\mathfrak{B}$ 가 존재한다. 따라서 A는 대각행렬 D와 닮음이다. $\mathfrak{B}$를 열로 가지며 $D=Q^{-1}AQ$ 를 만족하는 행렬 Q가 존재한다. 한편 Q의 열벡터는 $F^n$의 정규직교기저이므로 Q는 직교 행렬이다. 이 경우 A와 D를 직교 동치(orthogonally equivalent)라고 한다.
> 409page, 프리드 버그 선형대수학

정리해보면 아래와 같이 정리할 수 있다.
어떤 대칭 행렬 A는 A의 앞뒤로 $Q^{-1}$와 Q를 곱해줌으로써 대각행렬 D를 더을 수 있는데, 그 관계식을 아래와 같이 정리할 수 있다.

$$D = Q^{-1}AQ$$

여기서, Q의 형태가 정말 특별한데,

1. Q의 각각의 열벡터의 길이는 모두 1이다. 즉, Q의 열벡터의 norm은 1이다.
2. Q의 열벡터끼리는 직교한다. 즉, Q의 열벡터끼리의 내적값이 0이다.
3. Q는 $F^n$의 기저이다.
4. 게다가 Q의 열벡터는 모두 A의 고유벡터로 이루어져있다.

즉, 교재에서 말한바와 같이, 실대칭 행렬 A에는 Q라는 행렬이 항상 존재하는데, 이러한 Q는 열벡터가 **A의 고유벡터로 이루어진 (n차원 실수의)정규 직교 기저**이다.

## 상관 계수 행렬에 특별한 대각화를 적용해보자

상관계수 행렬 C는 실대칭 행렬이므로, 교재에서 말한대로 Q라는 행렬을 얻을 수 있을텐데, 그 형태는 아래와 같다.

|    U_1 |     U_2 |     U_3 |     U_4 |
|-------:|--------:|--------:|--------:|
| 0.4858 | -0.5553 | -0.5138 |  0.4378 |
| 0.4374 |  0.7323 |  0.0636 |  0.5181 |
| 0.5208 | -0.3278 |  0.7849 | -0.0726 |
| 0.549  |  0.2189 | -0.3405 | -0.7312 |

행렬 Q의 각 열벡터를 U1, U2, U3, U4라고 정의했다. (특별한 이유는 없고 그냥 본문에서 그렇게 하고 있기 때문에...)

그리고, 상관계수 행렬 C에 Q의 형태를 앞뒤로 곱해서 다음과 같은 대각행렬을 얻을 수 있다. 이를 D라고 하자.

|   고윳값1 |   고윳값2 |   고윳값3 |   고윳값4 |
|----:|----:|----:|----:|
|   2.964 |   0 |   0 |   0 |
|   0 |   0.761 |   0 |   0 |
|   0 |   0 |   0.184 |   0 |
|   0 |   0 |   0 |   0.091|

정리해보면, 우리는 샘플데이터를 이용해 상관계수 행렬을 구했고, 상관계수 행렬이 실대칭 행렬이라는 특징을 이용해 대각행렬 D와 상관계수 행렬의 고유벡터로 이루어지고, 각 열벡터가 정규직교기저인 행렬 Q를 얻었다. 그리고 그 형태는 위의 값과 같고, 아래와 같은 공식이 성립할 것이다.

$$D = Q^{-1}CQ$$

## ---

이제 주성분을 구해보자.
